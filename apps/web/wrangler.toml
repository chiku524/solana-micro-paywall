# Cloudflare Pages + Workers Converged Configuration
# This configuration merges both Pages and Workers into a single project
#
# Migration Note: This is being updated to support the converged Workers + Pages model
# which should resolve routing and DOCTYPE issues

name = "micropaywall"
compatibility_date = "2025-01-15"
compatibility_flags = ["nodejs_compat"]

# Pages configuration
pages_build_output_dir = ".vercel/output"

# D1 Database (shared between Pages and Workers)
[[d1_databases]]
binding = "DB"
database_name = "micropaywall-db"
database_id = "9fb849f1-b895-4670-baca-cdec2767f8c4"

# KV Namespace for caching (shared)
[[kv_namespaces]]
binding = "CACHE"
id = "7b095fcc4cb74cc787c1e7a20bf895a0"
preview_id = "0ab7737d5e184851a1127d4ecc4b1102"

# Production environment variables
[vars]
NODE_ENV = "production"
FRONTEND_URL = "https://micropaywall.app"
CORS_ORIGIN = "https://micropaywall.app,https://www.micropaywall.app"

